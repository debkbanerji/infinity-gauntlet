<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Infinity Gauntlet</title>
</head>
<body>
<h1>Infinity Gauntlet Debug Interface</h1>
<div>
    Debug Keys
    <ul>
        <li>t: Two Finger Tap</li>
        <li>f: All Fingers</li>
        <li>l: All Fingers</li>
        <li>r: All Fingers</li>
    </ul>
</div>

<p>Last relevant Input Key: <span id="last-relevant-key">None</span></p>
<p>Current Active State: <span id="curr-finger">None</span></p>


<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
<script>
    const config = {
        apiKey: "AIzaSyCwJg2yNQ5n_gMaAaX45CqeKvVW7dz_byg",
        authDomain: "infinity-gauntlet.firebaseapp.com",
        databaseURL: "https://infinity-gauntlet.firebaseio.com",
        projectId: "infinity-gauntlet",
        storageBucket: "infinity-gauntlet.appspot.com",
        messagingSenderId: "272863225901"
    };

    keyCodeMap = {
        t: 84,
        s: 83,
        f: 70,
        l: 76,
        r: 82
    };

    reverseKeyCodeMap = {
        '84': 't',
        '83': 's',
        '70': 'f',
        '76': 'l',
        '82': 'r'
    };

    firebase.initializeApp(config);

    firebase.database().ref('hands/hand_1/curr_finger').on('value', function(snapshot) {
        document.getElementById('curr-finger').innerHTML = snapshot.val();
    });

    document.addEventListener('keydown', function(event) {
        const keyCode = event.keyCode;
        // console.log(keyCode);

        let currFinger = null;
        if (keyCode === keyCodeMap.t) {
            currFinger = 'tap'
        } else if (keyCode === keyCodeMap.f || keyCode === keyCodeMap.l || keyCode === keyCodeMap.r) {
            currFinger = 'all'
        } else if (keyCode === keyCodeMap.s) {
            currFinger = 'idle'
        }
        // console.log(currFinger);
        if (currFinger) {
            firebase.database().ref('hands/hand_1/curr_finger').set(
                currFinger
            ).then(function () {
                // console.log('Pushed');
                setTimeout(function () {
                    firebase.database().ref('hands/hand_1/curr_finger').set('idle');
                }, 3000)
            });
        }

        // console.log(reverseKeyCodeMap[keyCode.toString()]);
        if (reverseKeyCodeMap[keyCode.toString()]) {
            document.getElementById('last-relevant-key').innerHTML = reverseKeyCodeMap[keyCode.toString()];
        }
    });
</script>
</body>
</html>